'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; /**
                                                                                                                                                                                                                                                                               * Copyright 2016-present, Prometheus Research, LLC. MIT License
                                                                                                                                                                                                                                                                               *
                                                                                                                                                                                                                                                                               * 
                                                                                                                                                                                                                                                                               */

exports.default = expand;

var _UnitlessNumberPropSet = require('./UnitlessNumberPropSet');

var _UnitlessNumberPropSet2 = _interopRequireDefault(_UnitlessNumberPropSet);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function expand(style) {
  var expandedStyle = {};
  for (var name in style) {
    if (!style.hasOwnProperty(name)) {
      continue;
    }
    Object.assign(expandedStyle, expandProp(name, style[name]));
  }
  return expandedStyle;
}

/**
 * Compile name: value property.
 */
function expandProp(name, value) {
  switch (name) {

    // extended variants

    case 'padding':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return compileLayoutSyntax('padding', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'margin':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return compileLayoutSyntax('margin', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'border':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('border', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'borderLeft':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('borderLeft', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'borderTop':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('borderTop', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'borderBottom':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('borderBottom', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'borderRight':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('borderRight', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'transition':
      return compileTransition(value);

    case 'outline':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return expandBorderSyntax('outline', value);
      } else {
        return expandSingleProp(name, value);
      }

    case 'boxShadow':
      return compileBoxShadow(value);

    case 'textShadow':
      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
        return compileTextShadowSyntax(value);
      } else {
        return expandSingleProp(name, value);
      }

    default:
      return expandSingleProp(name, value);
  }
}

function expandSingleProp(name, value) {
  return _defineProperty({}, name, Array.isArray(value) ? value : compileValue(name, value));
}

function expandBorderSyntax(name, value) {
  var _value$width = value.width,
      width = _value$width === undefined ? 'medium' : _value$width,
      _value$style = value.style,
      style = _value$style === undefined ? 'none' : _value$style,
      _value$color = value.color,
      color = _value$color === undefined ? 'currentColor' : _value$color;

  return _defineProperty({}, name, compileValue('borderWidth', width) + ' ' + String(style) + ' ' + String(color));
}

function compileLayoutSyntax(name, value) {
  var _value$vertical = value.vertical,
      vertical = _value$vertical === undefined ? 0 : _value$vertical,
      _value$horizontal = value.horizontal,
      horizontal = _value$horizontal === undefined ? 0 : _value$horizontal,
      _value$top = value.top,
      top = _value$top === undefined ? vertical : _value$top,
      _value$right = value.right,
      right = _value$right === undefined ? horizontal : _value$right,
      _value$bottom = value.bottom,
      bottom = _value$bottom === undefined ? vertical : _value$bottom,
      _value$left = value.left,
      left = _value$left === undefined ? horizontal : _value$left;

  return _defineProperty({}, name, compileValue('margin', top) + ' ' + compileValue('margin', right) + '  ' + compileValue('margin', bottom) + ' ' + compileValue('margin', left));
}

function compileBoxShadow(value) {
  return compileValueWith('boxShadow', value, compileBoxShadowValueSyntax);
}

function compileBoxShadowValueSyntax(value) {
  var _value$x = value.x,
      x = _value$x === undefined ? 0 : _value$x,
      _value$y = value.y,
      y = _value$y === undefined ? 0 : _value$y,
      _value$blur = value.blur,
      blur = _value$blur === undefined ? 0 : _value$blur,
      _value$spread = value.spread,
      spread = _value$spread === undefined ? 0 : _value$spread,
      _value$color2 = value.color,
      color = _value$color2 === undefined ? '#000' : _value$color2,
      _value$inset = value.inset,
      inset = _value$inset === undefined ? false : _value$inset;

  var css = String(x) + 'px ' + String(y) + 'px ' + String(blur) + 'px ' + String(spread) + 'px ' + String(color);
  if (inset) {
    css = 'inset ' + css;
  }
  return css;
}

function compileTextShadowSyntax(value) {
  var _value$x2 = value.x,
      x = _value$x2 === undefined ? 0 : _value$x2,
      _value$y2 = value.y,
      y = _value$y2 === undefined ? 0 : _value$y2,
      _value$blur2 = value.blur,
      blur = _value$blur2 === undefined ? 0 : _value$blur2,
      _value$color3 = value.color,
      color = _value$color3 === undefined ? '#000' : _value$color3;

  var css = String(x) + 'px ' + String(y) + 'px ' + String(blur) + 'px ' + String(color);
  return expandSingleProp('textShadow', css);
}

function compileTransition(value) {
  return compileValueWith('transition', value, compileTransitionValueSyntax);
}

function compileTransitionValueSyntax(value) {
  var _value$property = value.property,
      property = _value$property === undefined ? 'all' : _value$property,
      _value$duration = value.duration,
      duration = _value$duration === undefined ? 0 : _value$duration,
      _value$timingFunction = value.timingFunction,
      timingFunction = _value$timingFunction === undefined ? 'ease' : _value$timingFunction,
      _value$delay = value.delay,
      delay = _value$delay === undefined ? 0 : _value$delay;

  return String(property) + ' ' + String(duration) + 's ' + String(timingFunction) + ' ' + String(delay) + 's';
}

function compileValueWith(name, value, compileValue) {
  if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value != null) {
    var css = Array.isArray(value) ? value.map(function (value) {
      return typeof value === 'string' ? value : compileValue(value);
    }).join(', ') : compileValue(value);
    return expandSingleProp(name, css);
  } else {
    return expandSingleProp(name, value);
  }
}

/**
 * Compile style prop value.
 *
 * Based on code in React, see react/lib/dangerousStyleValue module.
 */
function compileValue(name, value) {
  var isNonNumeric = isNaN(value);
  if (isNonNumeric || value === 0 || _UnitlessNumberPropSet2.default.hasOwnProperty(name) && _UnitlessNumberPropSet2.default[name]) {
    return '' + value; // cast to string
  } else {
    return value + 'px';
  }
}
